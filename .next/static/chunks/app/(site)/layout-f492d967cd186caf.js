(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[457],{2474:function(e,t,s){Promise.resolve().then(s.t.bind(s,2835,23)),Promise.resolve().then(s.bind(s,7952)),Promise.resolve().then(s.bind(s,3624))},7952:function(e,t,s){"use strict";s.d(t,{default:function(){return r}});var n=s(7437),a=s(2265);function r(){let[e,t]=(0,a.useState)(""),[s,r]=(0,a.useState)([]);async function l(s){s.preventDefault(),r(t=>[...t,{role:"user",text:e}]),t("");let n=await fetch("/api/ai",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:e})}),a=await n.json();r(e=>[...e,{role:"assistant",text:a.answer}])}return(0,n.jsxs)("div",{className:"card-block w-72 fixed right-2 bottom-2 bg-mc-sky/90",children:[(0,n.jsx)("h2",{className:"font-mc text-sm mb-2",children:"AI Helper"}),(0,n.jsx)("div",{className:"h-40 overflow-y-auto bg-white/70 p-2 mb-2 text-xs",children:s.map((e,t)=>(0,n.jsx)("div",{className:"user"===e.role?"text-right":"text-left",children:(0,n.jsxs)("p",{children:[(0,n.jsxs)("strong",{children:["user"===e.role?"You":"AI",":"]})," ",e.text]})},t))}),(0,n.jsxs)("form",{onSubmit:l,className:"flex gap-1",children:[(0,n.jsx)("input",{value:e,onChange:e=>t(e.target.value),className:"flex-1 border rounded p-1 text-xs",placeholder:"Ask me..."}),(0,n.jsx)("button",{type:"submit",className:"btn-mc",children:"Go"})]})]})}},3624:function(e,t,s){"use strict";s.d(t,{default:function(){return o}});var n=s(7437),a=s(7138),r=s(2265),l=s(6463),c=s(1180);function o(e){let{initialUser:t,adminEmail:s}=e,o=(0,l.useRouter)(),u=(0,c.V4)(),d=s.toLowerCase(),[m,h]=(0,r.useState)(null!=t?t:null),[f,x]=(0,r.useState)(()=>i(t,d)),[b,p]=(0,r.useTransition)(),[N,v]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let e=!0;u.auth.getSession().then(t=>{var s,n;let{data:a}=t;if(!e)return;let r=null!==(n=null===(s=a.session)||void 0===s?void 0:s.user)&&void 0!==n?n:null;h(r),x(i(r,d))});let{data:t}=u.auth.onAuthStateChange((e,t)=>{var s;let n=null!==(s=null==t?void 0:t.user)&&void 0!==s?s:null;h(n),x(i(n,d)),p(()=>o.refresh())});return()=>{var s;e=!1,null==t||null===(s=t.subscription)||void 0===s||s.unsubscribe()}},[d,o,u]);let g=!!m;async function w(){v(!0),await Promise.allSettled([u.auth.signOut(),fetch("/logout",{method:"POST"})]),p(()=>{o.push("/"),o.refresh()}),v(!1)}return(0,n.jsx)("header",{className:"sticky top-0 z-40 border-b border-mc-wood-dark bg-mc-wood text-mc-parchment shadow-mc",children:(0,n.jsxs)("div",{className:"mx-auto flex max-w-5xl flex-wrap items-center gap-2 px-4 py-3 sm:gap-3",children:[(0,n.jsxs)(a.default,{href:"/",className:"flex shrink-0 items-center gap-2 whitespace-nowrap font-mc text-[0.7rem] uppercase tracking-[0.2em] hover:opacity-90",children:[(0,n.jsx)("span",{className:"inline-block h-4 w-4 rounded-sm bg-mc-leaf border border-mc-wood-dark shadow-pixel"}),"EJ Blog"]}),(0,n.jsxs)("nav",{className:"flex w-full flex-1 flex-wrap items-center gap-1.5 sm:w-auto sm:gap-2",children:[(0,n.jsx)(a.default,{className:"btn-mc",href:"/",children:"Blog"}),(0,n.jsx)(a.default,{className:"btn-mc",href:"/minecraft-zone",children:"Minecraft Zone"}),(0,n.jsx)(a.default,{className:"btn-mc",href:"/scratch-board",children:"Scratch Board"}),(0,n.jsx)(a.default,{className:"btn-mc",href:"/badger",children:"Badger"}),g&&(0,n.jsx)(a.default,{className:"btn-mc",href:"/post/new",children:"New Post"}),f&&(0,n.jsx)(a.default,{className:"btn-mc",href:"/moderation",children:"Parent / Moderation"})]}),(0,n.jsx)("div",{className:"ms-0 shrink-0 sm:ms-auto",children:g?(0,n.jsx)("button",{className:"btn-mc-secondary",disabled:b||N,onClick:w,children:N?"â€¦":"Log out"}):(0,n.jsx)(a.default,{className:"btn-mc-secondary",href:"/login",children:"Log in"})})]})})}function i(e,t){return null!=e&&!!e.email&&e.email.toLowerCase()===t}},1180:function(e,t,s){"use strict";s.d(t,{V4:function(){return l}});var n=s(5609),a=s(357);let r=null;function l(){return r||(r=(0,n.createBrowserClient)(a.env.NEXT_PUBLIC_SUPABASE_URL,a.env.NEXT_PUBLIC_SUPABASE_ANON_KEY))}t.ZP=l},7138:function(e,t,s){"use strict";s.d(t,{default:function(){return a.a}});var n=s(231),a=s.n(n)},2835:function(){}},function(e){e.O(0,[515,231,184,971,23,744],function(){return e(e.s=2474)}),_N_E=e.O()}]);