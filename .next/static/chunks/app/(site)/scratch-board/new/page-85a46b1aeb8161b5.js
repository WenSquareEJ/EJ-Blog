(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{4744:function(e,t,r){Promise.resolve().then(r.bind(r,4855))},4855:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return c}});var s=r(7437),n=r(2265),l=r(6463),a=r(1180);function c(){let e=(0,l.useRouter)(),t=(0,a.V4)(),[r,c]=(0,n.useState)(""),[u,i]=(0,n.useState)(""),[o,d]=(0,n.useState)(null),[h,m]=(0,n.useState)(!1);async function p(s){s.preventDefault(),d(null);let n=function(e){if(!e)return null;let t=e.trim();if(/^\d{3,}$/.test(t))return t;let r=t.match(/scratch\.mit\.edu\/projects\/(\d+)/i);return(null==r?void 0:r[1])?r[1]:null}(r);if(!n){d("Please enter a valid Scratch project URL or numeric ID.");return}m(!0);try{let{data:{user:r}}=await t.auth.getUser();if(!r){d("Please log in first.");return}let s={user_id:r.id,scratch_id:n,title:u||null},{error:l}=await t.from("scratch_projects").insert(s);if(l){d(l.message);return}d("Added! Redirecting…"),e.push("/scratch-board"),e.refresh()}catch(e){var l;d(null!==(l=null==e?void 0:e.message)&&void 0!==l?l:"Something went wrong.")}finally{m(!1)}}return(0,s.jsxs)("div",{className:"mx-auto max-w-lg w-full card-block space-y-4",children:[(0,s.jsx)("h1",{className:"font-mc text-xl",children:"➕ Add a Scratch project"}),(0,s.jsxs)("p",{className:"opacity-80 text-sm",children:["Paste a Scratch project link (e.g. ",(0,s.jsx)("code",{children:"https://scratch.mit.edu/projects/123456789/"}),") or just the project number."]}),(0,s.jsxs)("form",{onSubmit:p,className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm mb-1",children:"Project URL or ID"}),(0,s.jsx)("input",{className:"w-full rounded border px-3 py-2",value:r,onChange:e=>c(e.target.value),placeholder:"https://scratch.mit.edu/projects/123456789/",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm mb-1",children:"Title (optional)"}),(0,s.jsx)("input",{className:"w-full rounded border px-3 py-2",value:u,onChange:e=>i(e.target.value),placeholder:"My jumping cat game"})]}),o&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:o}),(0,s.jsx)("button",{type:"submit",className:"btn-mc",disabled:h,children:h?"Saving…":"Save"})]})]})}},1180:function(e,t,r){"use strict";r.d(t,{V4:function(){return a}});var s=r(5609),n=r(357);let l=null;function a(){return l||(l=(0,s.createBrowserClient)(n.env.NEXT_PUBLIC_SUPABASE_URL,n.env.NEXT_PUBLIC_SUPABASE_ANON_KEY))}t.ZP=a}},function(e){e.O(0,[184,971,23,744],function(){return e(e.s=4744)}),_N_E=e.O()}]);